---
- name: check if RVM is installed
  stat: path=~/.rvm
  register: st
- name: make sure curl is installed
  apt: pkg=curl
  sudo: true
- name: Import GPG key
  shell: "gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3" 
  when: not st.stat.exists
- name: Install RVM if it isn't installed
  shell: "\\curl -sSL https://get.rvm.io | bash -s stable --ruby"
  when: not st.stat.exists
- name: double check if RVM is installed
  stat: path=~/.rvm
  register: st
- name: Fail if RVM isn't installed
  fail: msg="RVM isn't installed {{ st }}"
  when: not st.stat.exists

